<Page x:Class="CollapseLauncher.Pages.PluginManagerPage"
      xmlns="http://schemas.microsoft.com/winfx/2006/xaml/presentation"
      xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml"
      xmlns:d="http://schemas.microsoft.com/expression/blend/2008"
      xmlns:mc="http://schemas.openxmlformats.org/markup-compatibility/2006"
      xmlns:ui="using:CommunityToolkit.WinUI"
      xmlns:media="using:CommunityToolkit.WinUI.Media"
      xmlns:animations="using:CommunityToolkit.WinUI.Animations"
      xmlns:interactivity="using:Microsoft.Xaml.Interactivity"
      xmlns:behaviors="using:CommunityToolkit.WinUI.Behaviors"
      xmlns:plugins="using:CollapseLauncher.Plugins"
      xmlns:controls="using:Hi3Helper.CommunityToolkit.WinUI.Controls"
      xmlns:extension="using:CollapseLauncher.Extension"
      xmlns:helper="using:Hi3Helper"
      xmlns:pages="using:CollapseLauncher.Pages"
      mc:Ignorable="d">
    <Page.Resources>
        <pages:GamePluginIconConverter x:Key="GamePluginIconConverter" />
        <pages:ByStringConverter x:Key="ByStringConverter" />
        <pages:GameNameLocaleConverter x:Key="GameNameLocaleConverter" />
        <pages:GameRegionLocaleConverter x:Key="GameRegionLocaleConverter" />
        <pages:LocalFullDateTimeConverter x:Key="LocalFullDateTimeConverter" />
        <pages:CountToIsEnabledConverter x:Key="CountToIsEnabledConverter" />
        <pages:BooleanVisibilityConverter x:Key="BooleanVisibilityConverter" />
        <pages:InverseBooleanVisibilityConverter x:Key="InverseBooleanVisibilityConverter"/>
        <pages:CountToVisibilityConverter x:Key="CountToVisibilityConverter"/>
        <pages:InverseCountToVisibilityConverter x:Key="InverseCountToVisibilityConverter"/>
        <pages:InverseBooleanConverter x:Key="InverseBooleanConverter"/>
        <pages:UpdateToVersionStringConverter x:Key="UpdateToVersionStringConverter"/>
        <x:Double x:Key="SettingsCardHeaderIconMaxSize">32</x:Double>
    </Page.Resources>
    <Grid ColumnSpacing="0">
        <Grid.ColumnDefinitions>
            <ColumnDefinition/>
            <ColumnDefinition Width=".58*"/>
        </Grid.ColumnDefinitions>
        <Grid Grid.Column="0"
              VerticalAlignment="Center"
              HorizontalAlignment="Center"
              RowSpacing="16"
              Visibility="{x:Bind pages:PluginManagerPage.Context.PluginCollection.Count, Converter={StaticResource InverseCountToVisibilityConverter}, Mode=OneWay}">
            <Grid.RowDefinitions>
                <RowDefinition Height="Auto"/>
                <RowDefinition Height="Auto"/>
                <RowDefinition Height="Auto"/>
            </Grid.RowDefinitions>
            <TextBlock Grid.Row="0"
                       Text="Hey, you have no plugin loaded!"
                       TextWrapping="Wrap"
                       TextAlignment="Center"
                       HorizontalAlignment="Center"
                       VerticalAlignment="Center"
                       Style="{ThemeResource TitleTextBlockStyle}"
                       FontSize="36"/>
            <Button x:Name="GoToPluginDownloadCatalogButton"
                    CornerRadius="{x:Bind extension:UIElementExtensions.AttachRoundedKindCornerRadius(GoToPluginDownloadCatalogButton)}"
                    BorderThickness="1"
                    Grid.Row="1"
                    HorizontalAlignment="Center">
                <Grid Margin="12,4"
                      ColumnSpacing="12">
                    <Grid.ColumnDefinitions>
                        <ColumnDefinition/>
                        <ColumnDefinition Width="Auto"/>
                    </Grid.ColumnDefinitions>
                    <TextBlock Grid.Column="0"
                               FontSize="14"
                               VerticalAlignment="Center">
                        <Run Text="Go to"/>
                        <Run Text="Plugin Download Catalog"
                             FontWeight="Bold"/>
                        <Run Text="page"/>
                    </TextBlock>
                    <FontIcon Grid.Column="1"
                              Glyph="&#xE826;"
                              FontSize="20"/>
                </Grid>
            </Button>
            <Image Grid.Row="2"
                   Source="ms-appx:///Assets/Images/GameMascot/PaimonThreateningAura.png"
                   Opacity=".4"
                   MaxWidth="260"
                   Margin="0,16,0,0"/>
        </Grid>
        <Grid x:Name="PluginManagementContainer"
              Grid.Column="0"
              RowSpacing="16"
              Margin="26,26,8,26"
              Visibility="{x:Bind pages:PluginManagerPage.Context.PluginCollection.Count, Converter={StaticResource CountToVisibilityConverter}, Mode=OneWay}">
            <Grid.RowDefinitions>
                <RowDefinition Height="Auto"/>
                <RowDefinition/>
                <RowDefinition Height="Auto"/>
            </Grid.RowDefinitions>
            <Grid Grid.Row="0">
                <Grid.ColumnDefinitions>
                    <ColumnDefinition/>
                    <ColumnDefinition Width="Auto"/>
                </Grid.ColumnDefinitions>
                <TextBlock Grid.Column="0"
                           Margin="8,0"
                           Text="Loaded Plugin Information"
                           Style="{ThemeResource TitleTextBlockStyle}"
                           FontSize="24"/>
                <StackPanel Grid.Column="1">
                    <Button Padding="2,2"
                            VerticalAlignment="Bottom"
                            Style="{ThemeResource TransparentDefaultButtonStyle}">
                        <Grid ColumnSpacing="4">
                            <Grid.ColumnDefinitions>
                                <ColumnDefinition/>
                                <ColumnDefinition Width="Auto"/>
                            </Grid.ColumnDefinitions>
                            <TextBlock Grid.Column="0"
                                       Text="Check for Updates"
                                       FontSize="12"
                                       VerticalAlignment="Center"
                                       Margin="8,0,0,0"/>
                            <FontIcon Grid.Column="1"
                                      Glyph="&#xE895;"
                                      FontSize="16"
                                      Margin="4,4,8,4"/>
                        </Grid>
                    </Button>
                </StackPanel>
            </Grid>
            <ListView x:Name="PluginListView"
                      Grid.Row="1"
                      RightTapped="OnListViewRightClickUpdate"
                      ItemsSource="{x:Bind pages:PluginManagerPage.Context.PluginCollection, Mode=OneWay}"
                      SelectionMode="Multiple"
                      Margin="-24,0,0,0">
                <ListView.ItemTemplate>
                    <DataTemplate x:DataType="plugins:PluginInfo">
                        <controls:SettingsExpander Padding="0"
                                                   HeaderIcon="{x:Bind Converter={StaticResource GamePluginIconConverter}}"
                                                   Visibility="Visible"
                                                   HorizontalAlignment="Stretch"
                                                   HorizontalContentAlignment="Stretch"
                                                   Loaded="{x:Bind extension:UIElementExtensions.AttachHandCursorOnLoaded}"
                                                   Margin="0,2,-8,2">
                            <controls:SettingsExpander.ContextFlyout>
                                <MenuFlyout>
                                    <MenuFlyoutItem Text="Uninstall Selected Plugins"
                                                    Command="{x:Bind plugins:PluginManagerPageContext.OnMarkForDeletionSelectedPluginsCommand}"
                                                    CommandParameter="{x:Bind pages:PluginManagerPage.This.PluginListView.SelectedItems}"
                                                    IsEnabled="{x:Bind pages:PluginManagerPage.Context.ListViewSelectedItemsCountRestored, Converter={StaticResource CountToIsEnabledConverter}, Mode=OneWay}">
                                        <MenuFlyoutItem.Icon>
                                            <FontIcon Glyph="&#xE74D;"/>
                                        </MenuFlyoutItem.Icon>
                                    </MenuFlyoutItem>
                                    <MenuFlyoutItem Text="Restore Selected Plugins"
                                                    Command="{x:Bind plugins:PluginManagerPageContext.OnRestoreFromDeletionSelectedPluginsCommand}"
                                                    CommandParameter="{x:Bind pages:PluginManagerPage.This.PluginListView.SelectedItems}"
                                                    IsEnabled="{x:Bind pages:PluginManagerPage.Context.ListViewSelectedItemsCountUninstalled, Converter={StaticResource CountToIsEnabledConverter}, Mode=OneWay}">
                                        <MenuFlyoutItem.Icon>
                                            <FontIcon Glyph="&#xE7A7;"/>
                                        </MenuFlyoutItem.Icon>
                                    </MenuFlyoutItem>
                                    <MenuFlyoutItem Text="Enable Selected Plugins"
                                                    Command="{x:Bind plugins:PluginManagerPageContext.OnEnableSelectedPluginsCommand}"
                                                    CommandParameter="{x:Bind pages:PluginManagerPage.This.PluginListView.SelectedItems}"
                                                    IsEnabled="{x:Bind pages:PluginManagerPage.Context.ListViewSelectedItemsCountDisabled, Converter={StaticResource CountToIsEnabledConverter}, Mode=OneWay}">
                                        <MenuFlyoutItem.Icon>
                                            <FontIcon Glyph="&#xE930;"/>
                                        </MenuFlyoutItem.Icon>
                                    </MenuFlyoutItem>
                                    <MenuFlyoutItem Text="Disable Selected Plugins"
                                                    Command="{x:Bind plugins:PluginManagerPageContext.OnDisableSelectedPluginsCommand}"
                                                    CommandParameter="{x:Bind pages:PluginManagerPage.This.PluginListView.SelectedItems}"
                                                    IsEnabled="{x:Bind pages:PluginManagerPage.Context.ListViewSelectedItemsCountEnabled, Converter={StaticResource CountToIsEnabledConverter}, Mode=OneWay}">
                                        <MenuFlyoutItem.Icon>
                                            <FontIcon Glyph="&#xEA39;"/>
                                        </MenuFlyoutItem.Icon>
                                    </MenuFlyoutItem>
                                    <MenuFlyoutSeparator Margin="8,8"/>
                                    <MenuFlyoutItem Text="Open Current Plugin Folder"
                                                    Command="{x:Bind plugins:PluginManagerPageContext.OnOpenCurrentPluginFolderCommand}"
                                                    CommandParameter="{x:Bind}">
                                        <MenuFlyoutItem.Icon>
                                            <FontIcon Glyph="&#xED43;"/>
                                        </MenuFlyoutItem.Icon>
                                    </MenuFlyoutItem>
                                    <MenuFlyoutItem Text="Open Collapse Launcher Plugin Folder"
                                                    Command="{x:Bind plugins:PluginManagerPageContext.OnOpenCollapsePluginFolderCommand}"
                                                    CommandParameter="{x:Bind}">
                                        <MenuFlyoutItem.Icon>
                                            <FontIcon Glyph="&#xED25;"/>
                                        </MenuFlyoutItem.Icon>
                                    </MenuFlyoutItem>
                                </MenuFlyout>
                            </controls:SettingsExpander.ContextFlyout>
                            <controls:SettingsExpander.Content>
                                <Grid ColumnSpacing="8"
                                      Loaded="{x:Bind extension:UIElementExtensions.AttachHandCursorRecursiveOnLoaded}">
                                    <Grid.ColumnDefinitions>
                                        <ColumnDefinition Width="Auto"/>
                                        <ColumnDefinition Width="Auto"/>
                                        <ColumnDefinition Width="Auto"/>
                                    </Grid.ColumnDefinitions>
                                    <Grid Grid.Column="0"
                                          Visibility="{x:Bind IsUpdateCheckInProgress, Converter={StaticResource BooleanVisibilityConverter}}">
                                        <Grid.ColumnDefinitions>
                                            <ColumnDefinition/>
                                            <ColumnDefinition Width="Auto"/>
                                        </Grid.ColumnDefinitions>
                                        <TextBlock Grid.Column="0"
                                                   Text="Checking updates"
                                                   FontSize="12"
                                                   VerticalAlignment="Center"/>
                                        <ProgressRing Grid.Column="1"
                                                      Width="12"
                                                      Height="12"
                                                      IsIndeterminate="True"/>
                                    </Grid>
                                    <Button Grid.Column="0"
                                            Padding="0"
                                            Tag="{x:Bind}"
                                            IsEnabled="{x:Bind IsUpdateInProgress, Converter={StaticResource InverseBooleanConverter}, Mode=OneWay}"
                                            Foreground="{ThemeResource SystemFillColorSuccess}"
                                            Visibility="{x:Bind IsUpdateAvailable, Converter={StaticResource BooleanVisibilityConverter}, Mode=OneWay}">
                                        <Grid ColumnSpacing="4">
                                            <Grid.ColumnDefinitions>
                                                <ColumnDefinition/>
                                                <ColumnDefinition Width="Auto"/>
                                            </Grid.ColumnDefinitions>
                                            <TextBlock Grid.Column="0"
                                                       Text="{x:Bind NextUpdateManifestInfo, Converter={StaticResource UpdateToVersionStringConverter}}"
                                                       Visibility="{x:Bind IsUpdateInProgress, Converter={StaticResource InverseBooleanVisibilityConverter}, Mode=OneWay}"
                                                       FontSize="12"
                                                       VerticalAlignment="Center"
                                                       Margin="8,0,0,0"/>
                                            <FontIcon Grid.Column="1"
                                                      Glyph="&#xE895;"
                                                      Visibility="{x:Bind IsUpdateInProgress, Converter={StaticResource InverseBooleanVisibilityConverter}, Mode=OneWay}"
                                                      FontSize="16"
                                                      Margin="4,4,8,4"/>
                                            <TextBlock Grid.Column="0"
                                                       Text="Updating (0%)"
                                                       Visibility="{x:Bind IsUpdateInProgress, Converter={StaticResource BooleanVisibilityConverter}, Mode=OneWay}"
                                                       FontSize="12"
                                                       VerticalAlignment="Center"
                                                       Margin="8,0,0,0"/>
                                            <ProgressRing Grid.Column="1"
                                                          Visibility="{x:Bind IsUpdateInProgress, Converter={StaticResource BooleanVisibilityConverter}, Mode=OneWay}"
                                                          Width="12"
                                                          Height="12"
                                                          IsIndeterminate="True"/>
                                        </Grid>
                                        <Button.Resources>
                                            <ResourceDictionary>
                                                <ResourceDictionary.ThemeDictionaries>
                                                    <!--  ReSharper disable Xaml.StaticResourceNotResolved  -->
                                                    <ResourceDictionary x:Key="Light">
                                                        <SolidColorBrush x:Key="ButtonBackground"
                                                                         Color="#106CCB5F"/>
                                                        <SolidColorBrush x:Key="ButtonBackgroundPointerOver"
                                                                         Color="#A06CCB5F"/>
                                                        <SolidColorBrush x:Key="ButtonBackgroundPressed"
                                                                         Color="#706CCB5F"/>
                                                    </ResourceDictionary>
                                                    <ResourceDictionary x:Key="Default">
                                                        <SolidColorBrush x:Key="ButtonBackground"
                                                                         Color="#100F7B0F"/>
                                                        <SolidColorBrush x:Key="ButtonBackgroundPointerOver"
                                                                         Color="#A00F7B0F"/>
                                                        <SolidColorBrush x:Key="ButtonBackgroundPressed"
                                                                         Color="#700F7B0F"/>
                                                    </ResourceDictionary>
                                                    <!--  ReSharper restore Xaml.StaticResourceNotResolved  -->
                                                </ResourceDictionary.ThemeDictionaries>
                                            </ResourceDictionary>
                                        </Button.Resources>
                                    </Button>
                                    <Button Grid.Column="1"
                                            Padding="0"
                                            Foreground="{ThemeResource SystemFillColorCritical}"
                                            Click="OnUninstallPlugin"
                                            Tag="{x:Bind}"
                                            Visibility="{x:Bind IsMarkedForDeletion, Converter={StaticResource InverseBooleanVisibilityConverter}, Mode=OneWay}">
                                        <Grid>
                                            <Grid.ColumnDefinitions>
                                                <ColumnDefinition/>
                                                <ColumnDefinition Width="Auto"/>
                                            </Grid.ColumnDefinitions>
                                            <TextBlock Grid.Column="0"
                                                       Text="Uninstall"
                                                       FontSize="12"
                                                       VerticalAlignment="Center"
                                                       Margin="8,0,0,0"/>
                                            <FontIcon Grid.Column="1"
                                                      Glyph="&#xE74D;"
                                                      FontSize="16"
                                                      Margin="4,4,8,4"/>
                                        </Grid>
                                        <Button.Resources>
                                            <ResourceDictionary>
                                                <ResourceDictionary.ThemeDictionaries>
                                                    <!--  ReSharper disable Xaml.StaticResourceNotResolved  -->
                                                    <ResourceDictionary x:Key="Light">
                                                        <SolidColorBrush x:Key="ButtonBackground"
                                                                         Color="#10FF0000"/>
                                                        <SolidColorBrush x:Key="ButtonBackgroundPointerOver"
                                                                         Color="#A0FF0000"/>
                                                        <SolidColorBrush x:Key="ButtonBackgroundPressed"
                                                                         Color="#70FF0000"/>
                                                    </ResourceDictionary>
                                                    <ResourceDictionary x:Key="Default">
                                                        <SolidColorBrush x:Key="ButtonBackground"
                                                                         Color="#10FF0000"/>
                                                        <SolidColorBrush x:Key="ButtonBackgroundPointerOver"
                                                                         Color="#A0FF0000"/>
                                                        <SolidColorBrush x:Key="ButtonBackgroundPressed"
                                                                         Color="#70FF0000"/>
                                                    </ResourceDictionary>
                                                    <!--  ReSharper restore Xaml.StaticResourceNotResolved  -->
                                                </ResourceDictionary.ThemeDictionaries>
                                            </ResourceDictionary>
                                        </Button.Resources>
                                    </Button>
                                    <Button Grid.Column="1"
                                            Padding="0"
                                            Click="OnRestoreUninstalledPlugin"
                                            Tag="{x:Bind}"
                                            Foreground="{ThemeResource SystemFillColorSuccess}"
                                            Visibility="{x:Bind IsMarkedForDeletion, Converter={StaticResource BooleanVisibilityConverter}, Mode=OneWay}">
                                        <Grid>
                                            <Grid.ColumnDefinitions>
                                                <ColumnDefinition/>
                                                <ColumnDefinition Width="Auto"/>
                                            </Grid.ColumnDefinitions>
                                            <TextBlock Grid.Column="0"
                                                       Text="Restore"
                                                       FontSize="12"
                                                       VerticalAlignment="Center"
                                                       Margin="8,0,0,0"/>
                                            <FontIcon Grid.Column="1"
                                                      Glyph="&#xE7A7;"
                                                      FontSize="16"
                                                      Margin="4,4,8,4"/>
                                        </Grid>
                                        <Button.Resources>
                                            <ResourceDictionary>
                                                <ResourceDictionary.ThemeDictionaries>
                                                    <!--  ReSharper disable Xaml.StaticResourceNotResolved  -->
                                                    <ResourceDictionary x:Key="Light">
                                                        <SolidColorBrush x:Key="ButtonBackground"
                                                                         Color="#106CCB5F"/>
                                                        <SolidColorBrush x:Key="ButtonBackgroundPointerOver"
                                                                         Color="#A06CCB5F"/>
                                                        <SolidColorBrush x:Key="ButtonBackgroundPressed"
                                                                         Color="#706CCB5F"/>
                                                    </ResourceDictionary>
                                                    <ResourceDictionary x:Key="Default">
                                                        <SolidColorBrush x:Key="ButtonBackground"
                                                                         Color="#100F7B0F"/>
                                                        <SolidColorBrush x:Key="ButtonBackgroundPointerOver"
                                                                         Color="#A00F7B0F"/>
                                                        <SolidColorBrush x:Key="ButtonBackgroundPressed"
                                                                         Color="#700F7B0F"/>
                                                    </ResourceDictionary>
                                                    <!--  ReSharper restore Xaml.StaticResourceNotResolved  -->
                                                </ResourceDictionary.ThemeDictionaries>
                                            </ResourceDictionary>
                                        </Button.Resources>
                                    </Button>
                                    <ToggleSwitch Grid.Column="2"
                                                  IsOn="{x:Bind IsEnabled, Mode=TwoWay}"
                                                  OnContent="{x:Bind helper:Locale.Lang._Misc.Enabled}"
                                                  OffContent="{x:Bind helper:Locale.Lang._Misc.Disabled}"
                                                  Scale="0.8,0.8,0.8"
                                                  Margin="0,0,-20,-8">
                                    </ToggleSwitch>
                                </Grid>
                            </controls:SettingsExpander.Content>
                            <controls:SettingsExpander.Header>
                                <TextBlock extension:TextBlockExtension.RemoveEmptyRuns="True">
                                    <Run Text="{x:Bind Name, Mode=OneWay}"/>
                                    <Run Text=" ("
                                         FontSize="10"
                                         FontWeight="Bold"
                                         extension:TextBlockExtension.PreserveSpace="True"/>
                                    <Run Text="{x:Bind PluginFileName, Mode=OneWay}"
                                         FontSize="10"
                                         FontWeight="Bold"/>
                                    <Run Text=")"
                                         FontSize="10"
                                         FontWeight="Bold"/>
                                </TextBlock>
                            </controls:SettingsExpander.Header>
                            <controls:SettingsExpander.Description>
                                <TextBlock Text="{x:Bind Author, Mode=OneWay, Converter={StaticResource ByStringConverter}}" />
                            </controls:SettingsExpander.Description>
                            <controls:SettingsExpander.Items>
                                <controls:SettingsCard HorizontalContentAlignment="Stretch"
                                                       HorizontalAlignment="Stretch"
                                                       ContentAlignment="Left"
                                                       Padding="16,16,16,16">
                                    <Grid HorizontalAlignment="Stretch">
                                        <Grid RowSpacing="4"
                                              ColumnSpacing="8"
                                              HorizontalAlignment="Stretch">
                                            <Grid.ColumnDefinitions>
                                                <ColumnDefinition Width="96"/>
                                                <ColumnDefinition/>
                                            </Grid.ColumnDefinitions>
                                            <Grid.RowDefinitions>
                                                <RowDefinition/>
                                                <RowDefinition/>
                                                <RowDefinition/>
                                                <RowDefinition/>
                                                <RowDefinition/>
                                                <RowDefinition/>
                                            </Grid.RowDefinitions>
                                            <TextBlock Text="{x:Bind helper:Locale.Lang._SettingsPage.Plugin_LoadedInfoDesc}"
                                                       Grid.Row="0"
                                                       Grid.Column="0"
                                                       FontSize="12"
                                                       Opacity=".75"
                                                       TextWrapping="Wrap"
                                                       HorizontalAlignment="Right"
                                                       TextAlignment="Right"/>
                                            <TextBlock Text="{x:Bind helper:Locale.Lang._SettingsPage.Plugin_LoadedInfoPluginVer}"
                                                       Grid.Row="1"
                                                       Grid.Column="0"
                                                       FontSize="12"
                                                       Opacity=".75"
                                                       TextWrapping="Wrap"
                                                       HorizontalAlignment="Right"
                                                       TextAlignment="Right"/>
                                            <TextBlock Text="{x:Bind helper:Locale.Lang._SettingsPage.Plugin_LoadedInfoInterfaceVer}"
                                                       Grid.Row="2"
                                                       Grid.Column="0"
                                                       FontSize="12"
                                                       Opacity=".75"
                                                       TextWrapping="Wrap"
                                                       HorizontalAlignment="Right"
                                                       TextAlignment="Right"/>
                                            <TextBlock Text="{x:Bind helper:Locale.Lang._SettingsPage.Plugin_LoadedInfoCreationDate}"
                                                       Grid.Row="3"
                                                       Grid.Column="0"
                                                       FontSize="12"
                                                       Opacity=".75"
                                                       TextWrapping="Wrap"
                                                       HorizontalAlignment="Right"
                                                       TextAlignment="Right"/>
                                            <TextBlock Text="{x:Bind helper:Locale.Lang._SettingsPage.Plugin_LoadedInfoMainLibLocation}"
                                                       Grid.Row="4"
                                                       Grid.Column="0"
                                                       FontSize="12"
                                                       Opacity=".75"
                                                       TextWrapping="Wrap"
                                                       HorizontalAlignment="Right"
                                                       TextAlignment="Right"/>
                                            <TextBlock Text="{x:Bind helper:Locale.Lang._SettingsPage.Plugin_LoadedInfoLoadedPresets}"
                                                       Grid.Row="5"
                                                       Grid.Column="0"
                                                       FontSize="12"
                                                       Opacity=".75"
                                                       TextWrapping="Wrap"
                                                       HorizontalAlignment="Right"
                                                       TextAlignment="Right"/>

                                            <TextBlock Text="{x:Bind Description, Mode=OneWay}"
                                                       Grid.Row="0"
                                                       Grid.Column="1"
                                                       FontSize="12"
                                                       TextWrapping="Wrap"
                                                       HorizontalAlignment="Left"/>
                                            <TextBlock Text="{x:Bind Version, Mode=OneWay}"
                                                       Grid.Row="1"
                                                       Grid.Column="1"
                                                       FontSize="12"
                                                       TextWrapping="Wrap"
                                                       HorizontalAlignment="Left"/>
                                            <TextBlock Text="{x:Bind StandardVersion, Mode=OneWay}"
                                                       Grid.Row="2"
                                                       Grid.Column="1"
                                                       FontSize="12"
                                                       TextWrapping="Wrap"
                                                       HorizontalAlignment="Left"/>
                                            <TextBlock Text="{x:Bind CreationDate, Mode=OneWay, Converter={StaticResource LocalFullDateTimeConverter}}"
                                                       Grid.Row="3"
                                                       Grid.Column="1"
                                                       FontSize="12"
                                                       TextWrapping="Wrap"
                                                       HorizontalAlignment="Left"/>
                                            <TextBlock Text="{x:Bind PluginFilePath, Mode=OneWay}"
                                                       Grid.Row="4"
                                                       Grid.Column="1"
                                                       FontSize="12"
                                                       TextWrapping="Wrap"
                                                       HorizontalAlignment="Left"/>
                                            <ItemsRepeater Grid.Row="5"
                                                           Grid.Column="1"
                                                           ItemsSource="{x:Bind PresetConfigs, Mode=OneWay}">
                                                <ItemsRepeater.ItemTemplate>
                                                    <DataTemplate x:DataType="plugins:PluginPresetConfigWrapper">
                                                        <TextBlock FontSize="12"
                                                                   TextWrapping="Wrap"
                                                                   HorizontalAlignment="Left"
                                                                   extension:TextBlockExtension.RemoveEmptyRuns="True">
                                                            <Run Text="• "
                                                                 extension:TextBlockExtension.PreserveSpace="True"/>
                                                            <Run Text="{x:Bind GameName, Mode=OneWay, Converter={StaticResource GameNameLocaleConverter}}"/>
                                                            <Run Text=" - "
                                                                 extension:TextBlockExtension.PreserveSpace="True"/>
                                                            <Run Text="{x:Bind ZoneName, Mode=OneWay, Converter={StaticResource GameRegionLocaleConverter}}"/>
                                                        </TextBlock>
                                                    </DataTemplate>
                                                </ItemsRepeater.ItemTemplate>
                                            </ItemsRepeater>
                                        </Grid>
                                        <Button Style="{ThemeResource TransparentDefaultButtonStyle}"
                                                Loaded="{x:Bind extension:UIElementExtensions.AttachHandCursorOnLoaded}"
                                                Click="{x:Bind pages:SettingsPage.CopyLoadedPluginInformationClick}"
                                                Padding="4"
                                                Margin="0,0,-16,-8"
                                                HorizontalAlignment="Right"
                                                VerticalAlignment="Bottom"
                                                Tag="{x:Bind}">
                                            <FontIcon Glyph="&#xE8C8;"
                                                      FontSize="16" />
                                            <Button.Flyout>
                                                <Flyout ShowMode="TransientWithDismissOnPointerMoveAway">
                                                    <Grid ColumnSpacing="6"
                                                          BorderThickness="0"
                                                          Margin="-16,-32"
                                                          Padding="12,0"
                                                          Background="{ThemeResource SystemFillColorSuccessBackgroundBrush}">
                                                        <Grid.ColumnDefinitions>
                                                            <ColumnDefinition/>
                                                            <ColumnDefinition/>
                                                        </Grid.ColumnDefinitions>
                                                        <FontIcon Glyph="&#xEC61;"
                                                                  Grid.Column="0"
                                                                  FontSize="16"
                                                                  VerticalAlignment="Center"
                                                                  Foreground="{ThemeResource SystemFillColorSuccessBrush}"/>
                                                        <TextBlock Text="{x:Bind helper:Locale.Lang._SettingsPage.Plugin_LoadedInfoClipboardCopied}"
                                                                   Grid.Column="1"
                                                                   FontWeight="Bold"
                                                                   Margin="0,-2,0,0"
                                                                   VerticalAlignment="Center" />
                                                    </Grid>
                                                </Flyout>
                                            </Button.Flyout>
                                        </Button>
                                    </Grid>
                                </controls:SettingsCard>
                            </controls:SettingsExpander.Items>
                        </controls:SettingsExpander>
                    </DataTemplate>
                </ListView.ItemTemplate>
            </ListView>
            <Grid Grid.Row="2"
                  HorizontalAlignment="Stretch">
                <Grid.ColumnDefinitions>
                    <ColumnDefinition/>
                    <ColumnDefinition Width="Auto"/>
                </Grid.ColumnDefinitions>
                <TextBlock Grid.Column="0"
                           Text="You need to restart your launcher in order to apply the changes!"
                           VerticalAlignment="Bottom"
                           HorizontalAlignment="Left"
                           TextWrapping="Wrap"
                           Visibility="{x:Bind RestartLauncherButton.IsEnabled, Converter={StaticResource BooleanVisibilityConverter}, Mode=OneWay}"/>
                <Button x:Name="RestartLauncherButton"
                        Grid.Column="1"
                        IsEnabled="{x:Bind pages:PluginManagerPage.Context.IsChanged, Mode=OneWay}"
                        HorizontalAlignment="Right"
                        Loaded="{x:Bind extension:UIElementExtensions.AttachHandCursorOnLoaded}"
                        CornerRadius="{x:Bind extension:UIElementExtensions.AttachRoundedKindCornerRadius(RestartLauncherButton)}"
                        Style="{ThemeResource AccentButtonStyle}">
                    <Grid ColumnSpacing="8">
                        <Grid.ColumnDefinitions>
                            <ColumnDefinition Width="Auto"/>
                            <ColumnDefinition/>
                        </Grid.ColumnDefinitions>
                        <FontIcon Glyph="&#xE777;"
                                  FontSize="16"/>
                        <TextBlock Grid.Column="1"
                                   Text="Restart the Launcher"
                                   FontSize="14"
                                   Margin="0,-1,0,0"/>
                    </Grid>
                </Button>
            </Grid>
        </Grid>
        <Grid x:Name="ImportBoxContainer"
              Grid.Column="1"
              Margin="8,26,26,26"
              HorizontalAlignment="Stretch"
              VerticalAlignment="Stretch">
            <Grid.Resources>
                <ResourceDictionary>
                    <ResourceDictionary.ThemeDictionaries>
                        <!--  ReSharper disable Xaml.StaticResourceNotResolved  -->
                        <ResourceDictionary x:Key="Light">
                            <SolidColorBrush x:Key="ImportBoxButtonBackground"
                                             Color="#B0FFFFFF" />
                            <SolidColorBrush x:Key="ButtonBackgroundPointerOver"
                                             Color="#0FFFFFFF" />
                            <SolidColorBrush x:Key="ButtonBackgroundPressed"
                                             Color="#60FFFFFF" />
                        </ResourceDictionary>
                        <ResourceDictionary x:Key="Default">
                            <SolidColorBrush x:Key="ImportBoxButtonBackground"
                                             Color="#40000000" />
                            <SolidColorBrush x:Key="ButtonBackgroundPointerOver"
                                             Color="#30000000" />
                            <SolidColorBrush x:Key="ButtonBackgroundPressed"
                                             Color="#50000000" />
                        </ResourceDictionary>
                        <!--  ReSharper restore Xaml.StaticResourceNotResolved  -->
                    </ResourceDictionary.ThemeDictionaries>
                </ResourceDictionary>
            </Grid.Resources>
            <Button x:Name="ImportBoxButton"
                    CornerRadius="20"
                    VerticalAlignment="Stretch"
                    HorizontalAlignment="Stretch"
                    Background="{StaticResource ImportBoxButtonBackground}"
                    Click="OnClickImportButton">
                <interactivity:Interaction.Behaviors>
                    <interactivity:EventTriggerBehavior EventName="PointerEntered">
                        <behaviors:StartAnimationAction Animation="{x:Bind ImportBoxPlusGridEnterAnimation}"/>
                    </interactivity:EventTriggerBehavior>
                    
                    <interactivity:EventTriggerBehavior EventName="PointerExited">
                        <behaviors:StartAnimationAction Animation="{x:Bind ImportBoxPlusGridExitAnimation}"/>
                    </interactivity:EventTriggerBehavior>

                    <interactivity:EventTriggerBehavior EventName="PointerPressed">
                        <behaviors:StartAnimationAction Animation="{x:Bind ImportBoxPlusGridPressedAnimation}"/>
                    </interactivity:EventTriggerBehavior>

                    <interactivity:EventTriggerBehavior EventName="PointerReleased">
                        <behaviors:StartAnimationAction Animation="{x:Bind ImportBoxPlusGridExitAnimation}"/>
                    </interactivity:EventTriggerBehavior>
                </interactivity:Interaction.Behaviors>
                
                <Grid VerticalAlignment="Center"
                      HorizontalAlignment="Center"
                      RowSpacing="32">
                    <Grid.RowDefinitions>
                        <RowDefinition Height="Auto"/>
                        <RowDefinition Height="Auto"/>
                    </Grid.RowDefinitions>
                    <Button x:Name="ImportBoxPlusGrid"
                            Grid.Row="0"
                            Background="{ThemeResource ImportBoxButtonBackground}"
                            Width="128"
                            Height="128"
                            CornerRadius="24"
                            HorizontalAlignment="Center"
                            BorderBrush="{ThemeResource ButtonBorderBrushPressed}"
                            RenderTransformOrigin="0.5,0.5"
                            Opacity=".75"
                            Click="OnClickImportButton">
                        <ui:Effects.Shadow>
                            <media:AttachedCardShadow Offset="0, 2, 0"
                                                      Opacity=".1"
                                                      BlurRadius="8"
                                                      CornerRadius="{x:Bind ImportBoxPlusGrid.CornerRadius, Mode=OneWay, Converter={StaticResource BottomRightCornerRadiusDoubleValueConverter}}"/>
                        </ui:Effects.Shadow>
                        <animations:Explicit.Animations>
                            <animations:AnimationSet x:Name="ImportBoxPlusGridPressedAnimation">
                                <animations:OffsetDropShadowAnimation To="0, 0, 0"
                                                                      Duration="0:0:.25"/>
                                <animations:OpacityDropShadowAnimation To=".25"
                                                                       Duration="0:0:.25"/>
                                <animations:BlurRadiusDropShadowAnimation To="0"
                                                                          Duration="0:0:.25"/>
                                <animations:OpacityAnimation To=".5"
                                                             Duration="0:0:.25"/>
                            </animations:AnimationSet>
                            
                            <animations:AnimationSet x:Name="ImportBoxPlusGridEnterAnimation">
                                <animations:OffsetDropShadowAnimation To="0, 8, 0"
                                                                      Duration="0:0:.25"/>
                                <animations:OpacityDropShadowAnimation To=".25"
                                                                       Duration="0:0:.25"/>
                                <animations:BlurRadiusDropShadowAnimation To="32"
                                                                          Duration="0:0:.25"/>
                                <animations:OpacityAnimation To="1"
                                                             Duration="0:0:.25"/>
                            </animations:AnimationSet>

                            <animations:AnimationSet x:Name="ImportBoxPlusGridExitAnimation">
                                <animations:OffsetDropShadowAnimation To="0, 2, 0"
                                                                      Duration="0:0:.25"/>
                                <animations:OpacityDropShadowAnimation To=".1"
                                                                       Duration="0:0:.25"/>
                                <animations:BlurRadiusDropShadowAnimation To="8"
                                                                          Duration="0:0:.25"/>
                                <animations:OpacityAnimation To=".75"
                                                             Duration="0:0:.25"/>
                            </animations:AnimationSet>
                        </animations:Explicit.Animations>

                        <FontIcon Glyph="&#xE710;"
                                  FontSize="48z"/>
                    </Button>
                    <StackPanel Grid.Row="1"
                                Spacing="16">
                        <TextBlock FontSize="32"
                                   Margin="16,0"
                                   MaxWidth="420"
                                   TextWrapping="Wrap"
                                   TextAlignment="Center"
                                   HorizontalTextAlignment="Center"
                                   HorizontalAlignment="Center">
                            <Run Text="Drag the"/>
                            <Run Text=".zip" FontWeight="Bold"/>
                            <Run Text="or"/>
                            <Run Text="manifest.json" FontWeight="Bold"/>
                            <Run Text="here"/>
                        </TextBlock>
                        <TextBlock FontSize="18"
                                   Margin="16,0"
                                   Opacity=".5"
                                   MaxWidth="420"
                                   TextWrapping="Wrap"
                                   TextAlignment="Center"
                                   HorizontalTextAlignment="Center"
                                   HorizontalAlignment="Center"
                                   Text="or click this box to import the plugin"/>
                    </StackPanel>
                </Grid>
            </Button>
        </Grid>
    </Grid>
</Page>
