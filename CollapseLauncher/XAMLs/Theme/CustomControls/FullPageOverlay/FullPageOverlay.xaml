<ResourceDictionary xmlns="http://schemas.microsoft.com/winfx/2006/xaml/presentation"
                    xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml"
                    xmlns:controls="using:CollapseLauncher.XAMLs.Theme.CustomControls.FullPageOverlay">
    <ResourceDictionary.ThemeDictionaries>
        <ResourceDictionary x:Key="Default">
            <SolidColorBrush x:Key="SmokeBackgroundBrush"
                             Color="{ThemeResource SmokeFillColorDefault}"/>
            <AcrylicBrush x:Key="ContentBackgroundAcrylicBrush"
                          TintOpacity="1"
                          TintLuminosityOpacity="0"
                          TintColor="{ThemeResource SmokeFillColorDefault}"
                          FallbackColor="{ThemeResource SmokeFillColorDefault}"/>
        </ResourceDictionary>
        <ResourceDictionary x:Key="Light">
            <SolidColorBrush x:Key="SmokeBackgroundBrush"
                             Color="{ThemeResource CardBackgroundFillColorSecondary}"
                             Opacity="0.6"/>
            <AcrylicBrush x:Key="ContentBackgroundAcrylicBrush"
                          TintOpacity="0.0"
                          TintLuminosityOpacity="0.8"
                          TintColor="{ThemeResource ControlFillColorDefault}"/>
        </ResourceDictionary>
    </ResourceDictionary.ThemeDictionaries>

    <StaticResource x:Key="BackgroundBrush"
                    ResourceKey="CardBackgroundFillColorDefaultBrush" />
    <StaticResource x:Key="StrokeColorBrush"
                    ResourceKey="CardStrokeColorDefaultBrush" />
    <StaticResource x:Key="ContentDialogSmokeFill"
                    ResourceKey="SmokeFillColorCollapseBrush" />

    <ThemeShadow x:Key="SharedShadow" />

    <Style TargetType="controls:FullPageOverlay">
        <Setter Property="Size" Value="Full"/>
        <Setter Property="Background" Value="{StaticResource SmokeBackgroundBrush}"/>
        <Setter Property="ContentBackground" Value="{StaticResource ContentBackgroundAcrylicBrush}"/>
        <Setter Property="CornerRadius" Value="8"/>
        <Setter Property="Template">
            <Setter.Value>
                <ControlTemplate TargetType="controls:FullPageOverlay">
                    <Border x:Name="Container">

                        <VisualStateManager.VisualStateGroups>
                            <VisualStateGroup x:Name="OverlayShowingStates">
                                <VisualStateGroup.Transitions>
                                    <VisualTransition To="OverlayHidden">
                                        <Storyboard>
                                            <ObjectAnimationUsingKeyFrames Storyboard.TargetName="LayoutRoot"
                                                                           Storyboard.TargetProperty="Visibility">
                                                <DiscreteObjectKeyFrame KeyTime="0:0:0"
                                                                        Value="Visible" />
                                            </ObjectAnimationUsingKeyFrames>
                                            <ObjectAnimationUsingKeyFrames Storyboard.TargetName="LayoutRoot"
                                                                           Storyboard.TargetProperty="IsHitTestVisible">
                                                <DiscreteObjectKeyFrame KeyTime="0:0:0"
                                                                        Value="False" />
                                            </ObjectAnimationUsingKeyFrames>
                                            <DoubleAnimationUsingKeyFrames Storyboard.TargetName="ScaleTransform"
                                                                           Storyboard.TargetProperty="ScaleX">
                                                <DiscreteDoubleKeyFrame KeyTime="0:0:0"
                                                                        Value="1.0" />
                                                <SplineDoubleKeyFrame KeySpline="{StaticResource ControlFastOutSlowInKeySpline}"
                                                                      KeyTime="{StaticResource ControlFastAnimationDuration}"
                                                                      Value="1.05" />
                                            </DoubleAnimationUsingKeyFrames>
                                            <DoubleAnimationUsingKeyFrames Storyboard.TargetName="ScaleTransform"
                                                                           Storyboard.TargetProperty="ScaleY">
                                                <DiscreteDoubleKeyFrame KeyTime="0:0:0"
                                                                        Value="1.0" />
                                                <SplineDoubleKeyFrame KeySpline="{StaticResource ControlFastOutSlowInKeySpline}"
                                                                      KeyTime="{StaticResource ControlFastAnimationDuration}"
                                                                      Value="1.05" />
                                            </DoubleAnimationUsingKeyFrames>
                                            <DoubleAnimationUsingKeyFrames Storyboard.TargetName="LayoutRoot"
                                                                           Storyboard.TargetProperty="Opacity">
                                                <DiscreteDoubleKeyFrame KeyTime="0:0:0"
                                                                        Value="1.0" />
                                                <LinearDoubleKeyFrame KeyTime="{StaticResource ControlFasterAnimationDuration}"
                                                                      Value="0.0" />
                                            </DoubleAnimationUsingKeyFrames>
                                            <DoubleAnimationUsingKeyFrames Storyboard.TargetName="CloseButton"
                                                                           Storyboard.TargetProperty="Opacity">
                                                <DiscreteDoubleKeyFrame KeyTime="0:0:0"
                                                                        Value="1.0" />
                                                <LinearDoubleKeyFrame KeyTime="{StaticResource ControlNormalAnimationDuration}"
                                                                      Value="0.0" />
                                            </DoubleAnimationUsingKeyFrames>
                                            <DoubleAnimationUsingKeyFrames Storyboard.TargetName="CloseButtonTranslateTransform"
                                                                           Storyboard.TargetProperty="X">
                                                <DiscreteDoubleKeyFrame KeyTime="0:0:0"
                                                                        Value="0" />
                                                <SplineDoubleKeyFrame KeySpline="{StaticResource ControlFastOutSlowInKeySpline}"
                                                                      KeyTime="{StaticResource ControlNormalAnimationDuration}"
                                                                      Value="32" />
                                            </DoubleAnimationUsingKeyFrames>
                                        </Storyboard>
                                    </VisualTransition>
                                    <VisualTransition To="OverlayShowing">
                                        <Storyboard>
                                            <ObjectAnimationUsingKeyFrames Storyboard.TargetName="LayoutRoot"
                                                                           Storyboard.TargetProperty="Visibility">
                                                <DiscreteObjectKeyFrame KeyTime="0:0:0"
                                                                        Value="Visible" />
                                            </ObjectAnimationUsingKeyFrames>
                                            <DoubleAnimationUsingKeyFrames Storyboard.TargetName="ScaleTransform"
                                                                           Storyboard.TargetProperty="ScaleX">
                                                <DiscreteDoubleKeyFrame KeyTime="0:0:0"
                                                                        Value="1.05" />
                                                <SplineDoubleKeyFrame KeySpline="{StaticResource ControlFastOutSlowInKeySpline}"
                                                                      KeyTime="{StaticResource ControlNormalAnimationDuration}"
                                                                      Value="1.0" />
                                            </DoubleAnimationUsingKeyFrames>
                                            <DoubleAnimationUsingKeyFrames Storyboard.TargetName="ScaleTransform"
                                                                           Storyboard.TargetProperty="ScaleY">
                                                <DiscreteDoubleKeyFrame KeyTime="0:0:0"
                                                                        Value="1.05" />
                                                <SplineDoubleKeyFrame KeySpline="{StaticResource ControlFastOutSlowInKeySpline}"
                                                                      KeyTime="{StaticResource ControlNormalAnimationDuration}"
                                                                      Value="1.0" />
                                            </DoubleAnimationUsingKeyFrames>
                                            <DoubleAnimationUsingKeyFrames Storyboard.TargetName="LayoutRoot"
                                                                           Storyboard.TargetProperty="Opacity">
                                                <DiscreteDoubleKeyFrame KeyTime="0:0:0"
                                                                        Value="0.0" />
                                                <LinearDoubleKeyFrame KeyTime="{StaticResource ControlFasterAnimationDuration}"
                                                                      Value="1.0" />
                                            </DoubleAnimationUsingKeyFrames>
                                            <DoubleAnimationUsingKeyFrames Storyboard.TargetName="CloseButton"
                                                                           Storyboard.TargetProperty="Opacity">
                                                <DiscreteDoubleKeyFrame KeyTime="0:0:0"
                                                                        Value="0.0" />
                                                <LinearDoubleKeyFrame KeyTime="{StaticResource ControlNormalAnimationDuration}"
                                                                      Value="1.0" />
                                            </DoubleAnimationUsingKeyFrames>
                                            <DoubleAnimationUsingKeyFrames Storyboard.TargetName="CloseButtonTranslateTransform"
                                                                           Storyboard.TargetProperty="X">
                                                <DiscreteDoubleKeyFrame KeyTime="0:0:0"
                                                                        Value="32" />
                                                <SplineDoubleKeyFrame KeySpline="{StaticResource ControlFastOutSlowInKeySpline}"
                                                                      KeyTime="{StaticResource ControlNormalAnimationDuration}"
                                                                      Value="0" />
                                            </DoubleAnimationUsingKeyFrames>
                                        </Storyboard>
                                    </VisualTransition>
                                </VisualStateGroup.Transitions>
                                <VisualState x:Name="OverlayHidden"/>
                                <VisualState x:Name="OverlayShowing">
                                    <VisualState.Setters>
                                        <Setter Target="LayoutRoot.Visibility" Value="Visible" />
                                        <Setter Target="Presenter.TabFocusNavigation" Value="Cycle" />
                                    </VisualState.Setters>
                                </VisualState>
                            </VisualStateGroup>
                            <VisualStateGroup x:Name="OverlaySizeStates">
                                <!-- Size-specific states -->
                                <VisualState x:Name="OverlaySizeFull">
                                    <VisualState.Setters>
                                        <Setter Target="SmokeLayerBackground.Visibility" Value="Visible" />
                                        <Setter Target="PresenterContainer.HorizontalAlignment" Value="Stretch" />
                                        <Setter Target="PresenterContainer.VerticalAlignment" Value="Stretch" />
                                        <Setter Target="Presenter.Margin" Value="16, 64, 16, 16" />
                                    </VisualState.Setters>
                                </VisualState>
                                <VisualState x:Name="OverlaySizeFullNoGap">
                                    <VisualState.Setters>
                                        <Setter Target="SmokeLayerBackground.Visibility" Value="Collapsed" />
                                        <Setter Target="PresenterContainer.HorizontalAlignment" Value="Stretch" />
                                        <Setter Target="PresenterContainer.VerticalAlignment" Value="Stretch" />
                                        <Setter Target="Presenter.Margin" Value="0" />
                                    </VisualState.Setters>
                                </VisualState>
                                <VisualState x:Name="OverlaySizeFollowContent">
                                    <VisualState.Setters>
                                        <Setter Target="SmokeLayerBackground.Visibility" Value="Visible" />
                                        <Setter Target="PresenterContainer.HorizontalAlignment" Value="Center" />
                                        <Setter Target="PresenterContainer.VerticalAlignment" Value="Center" />
                                        <Setter Target="Presenter.Margin" Value="16, 64, 16, 16" />
                                    </VisualState.Setters>
                                </VisualState>
                            </VisualStateGroup>
                        </VisualStateManager.VisualStateGroups>
                        <Grid x:Name="LayoutRoot">
                            <Rectangle x:Name="SmokeLayerBackground"
                                       Fill="{TemplateBinding Background}"/>
                            
                            <Grid x:Name="PresenterContainer"
                                  RenderTransformOrigin="0.5,0.5">
                                <Grid.RenderTransform>
                                    <ScaleTransform x:Name="ScaleTransform" />
                                </Grid.RenderTransform>
                                <Grid x:Name="OverlayTitleGrid"
                                      Background="{TemplateBinding ContentBackground}"
                                      Margin="16,16,0,0"
                                      Padding="12,8"
                                      HorizontalAlignment="Left"
                                      VerticalAlignment="Top"
                                      CornerRadius="8"
                                      Shadow="{ThemeResource SharedShadow}"
                                      Translation="0,0,16"
                                      ColumnSpacing="8">
                                    <Grid.ColumnDefinitions>
                                        <ColumnDefinition Width="Auto"/>
                                        <ColumnDefinition/>
                                    </Grid.ColumnDefinitions>
                                    <Grid Grid.Column="0"
                                          MaxWidth="24"
                                          MaxHeight="24"
                                          CornerRadius="4">
                                        <IconSourceElement IconSource="{TemplateBinding OverlayTitleIcon}"
                                                           VerticalAlignment="Center"
                                                           HorizontalAlignment="Center"/>
                                    </Grid>
                                    <TextBlock Grid.Column="1"
                                               Text="{TemplateBinding OverlayTitle}"
                                               FontSize="14"
                                               FontWeight="Normal"
                                               VerticalAlignment="Center"
                                               HorizontalAlignment="Center"/>
                                </Grid>
                                <ContentPresenter x:Name="Presenter"
                                                  Content="{TemplateBinding Content}"
                                                  Shadow="{StaticResource SharedShadow}"
                                                  CornerRadius="{TemplateBinding CornerRadius}"
                                                  Background="{TemplateBinding ContentBackground}"
                                                  Translation="0,0,64"/>
                            </Grid>

                            <Button x:Name="CloseButton"
                                    Height="32"
                                    HorizontalAlignment="Right"
                                    VerticalAlignment="Top"
                                    Margin="0, 8, 96, 0"
                                    CornerRadius="8"
                                    Style="{ThemeResource NewAccentButtonStyle}"
                                    Opacity="1"
                                    Shadow="{ThemeResource SharedShadow}"
                                    Translation="0,0,16">
                                <Button.RenderTransform>
                                    <TranslateTransform x:Name="CloseButtonTranslateTransform"/>
                                </Button.RenderTransform>
                                <Grid ColumnSpacing="8">
                                    <Grid.ColumnDefinitions>
                                        <ColumnDefinition/>
                                        <ColumnDefinition Width="Auto"/>
                                    </Grid.ColumnDefinitions>
                                    <TextBlock Grid.Column="0"
                                               FontWeight="Bold"
                                               Text="Close Overlay"/>
                                    <Path Grid.Column="1"
                                          Width="10"
                                          Height="10"
                                          Data="M 0 0 L 10 10 M 10 0 L 0 10"
                                          Stretch="Fill"
                                          Stroke="{ThemeResource TextFillColorInverseBrush}"
                                          StrokeEndLineCap="Round"
                                          StrokeStartLineCap="Round"
                                          StrokeThickness="2"
                                          UseLayoutRounding="True" />
                                </Grid>
                            </Button>
                        </Grid>
                    </Border>
                </ControlTemplate>
            </Setter.Value>
        </Setter>
    </Style>
</ResourceDictionary>